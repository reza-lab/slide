<html xmlns="http://www.w3.org/1999/xhtml"><head><title></title><meta charset="UTF-8"><meta name="generator" content="bildumilo 1.0 https://github.com/yoosofan/bildumilo"><link rel="stylesheet" href="css/hovercraft.css" media="all"><link rel="stylesheet" href="css/highlight.css" media="all"><link rel="stylesheet" href="css/style.css" media="all"><script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        showProcessingMessages: false,
        messageStyle: "none",
        TeX : { extensions : ['color.js'] }
      });
    </script></head><body class="impress-not-supported"><div id="impress" data-width="1024" data-transition-duration="1000"><div class="step step-level-1" step="0" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="0" data-z="0"><h1 id="function-in-sql">Function in SQL</h1><h2 id="postgresql">PostgreSQL</h2><p>Ahmad Yoosofan</p><p>Database course</p><p>University of Kashan, Spring 2021</p></div><div class="step step-level-1 t2c" step="1" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="1600" data-y="0" data-z="0"><h1 id="sample-1">sample 1</h1><pre class="highlight code sql"><span class="ln">1 </span><span class="k">CREATE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">f_typetest01</span><span class="p">(</span><span class="nb">INTEGER</span><span class="p">)</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="n">bool</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">AS</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="s1">'SELECT TRUE'</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="k">LANGUAGE</span><span class="w"> </span><span class="k">sql</span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="ln">1 </span><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">f_typetest01</span><span class="p">(</span><span class="nb">INTEGER</span><span class="p">)</span><span class="w">
</span><span class="ln">2 </span><span class="w">  </span><span class="k">RETURNS</span><span class="w"> </span><span class="n">bool</span><span class="w">
</span><span class="ln">3 </span><span class="w">  </span><span class="k">AS</span><span class="w">
</span><span class="ln">4 </span><span class="w">  </span><span class="s1">'SELECT TRUE'</span><span class="w">
</span><span class="ln">5 </span><span class="w">  </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="k">sql</span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="n">f_typetest01</span><span class="p">(</span><span class="mi">12</span><span class="p">);</span></pre><pre class="highlight code sh substep">f_typetest01<span class="w">
</span>--------------<span class="w">
</span>t<span class="w">
</span><span class="o">(</span><span class="m">1</span><span class="w"> </span>row<span class="o">)</span></pre><pre class="highlight code sql substep"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w">
</span><span class="k">from</span><span class="w"> </span><span class="n">f_typetest01</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w">
</span><span class="p">;</span></pre><pre class="highlight code sh substep">f_typetest01<span class="w">
</span>--------------<span class="w">
</span>t<span class="w">
</span><span class="o">(</span><span class="m">1</span><span class="w"> </span>row<span class="o">)</span></pre></div><div class="step step-level-1" step="2" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="3200" data-y="0" data-z="0"><h1 id="sample-2">Sample 2</h1><pre class="highlight code sql"><span class="ln">1 </span><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">myf</span><span class="p">(</span><span class="n">d1</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">)</span><span class="w"> </span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">AS</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="err">$$</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">MAX</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">sn</span><span class="o">=</span><span class="n">d1</span><span class="p">;</span><span class="w">
</span><span class="ln">5 </span><span class="w"></span><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="k">SQL</span><span class="p">;</span></pre><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="n">myf</span><span class="p">(</span><span class="s1">'S1'</span><span class="p">)</span><span class="w">
</span><span class="p">;</span></pre><pre class="highlight code sh"><span class="w"> </span>myf<span class="w">
</span>-----<span class="w">
 </span><span class="m">400</span><span class="w">
</span><span class="o">(</span><span class="m">1</span><span class="w"> </span>row<span class="o">)</span></pre></div><div class="step step-level-1" step="3" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="4800" data-y="0" data-z="0"><h1 id="sample-3">Sample 3</h1><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">DROP</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">test03</span><span class="p">();</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">test03</span><span class="p">()</span><span class="w"> </span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$</span><span class="n">ABC$</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">DECLARE</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">  </span><span class="n">quantity</span><span class="w"> </span><span class="nb">integer</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="n">q2</span><span class="w"> </span><span class="nb">integer</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w">
</span><span class="ln"> 6 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">  </span><span class="c1">-- RAISE NOTICE 'Quantity here is %', quantity; -- Prints 30
</span><span class="ln"> 8 </span><span class="c1"></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">q2</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="p">;</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="n">q2</span><span class="p">;</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">11 </span><span class="w"></span><span class="err">$</span><span class="n">ABC$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="p">;</span></pre></div><div class="step step-level-1" step="4" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="6400" data-y="0" data-z="0"><h1 id="function-parts">Function parts</h1><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">DROP</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">somefunc</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span><span class="w">
</span><span class="ln"> 2 </span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">somefunc</span><span class="p">(</span><span class="n">nm1</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$</span><span class="n">ABC$</span><span class="w">
</span><span class="ln"> 4 </span><span class="w"></span><span class="k">DECLARE</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="n">quantity</span><span class="w"> </span><span class="nb">integer</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w">
</span><span class="ln"> 6 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">  </span><span class="c1">-- RAISE NOTICE 'Quantity here is %', quantity; -- Prints 30
</span><span class="ln"> 8 </span><span class="c1"></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">quantity</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">sn</span><span class="o">=</span><span class="n">nm1</span><span class="p">;</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">  </span><span class="n">quantity</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">quantity</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span><span class="w">
</span><span class="ln">10 </span><span class="w">  </span><span class="cm">/*
</span><span class="ln">11 </span><span class="cm">  -- Create a subblock
</span><span class="ln">12 </span><span class="cm">  --
</span><span class="ln">13 </span><span class="cm">  RAISE NOTICE 'Quantity here is %', quantity;*/</span><span class="w">
</span><span class="ln">14 </span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="n">quantity</span><span class="p">;</span><span class="w">
</span><span class="ln">15 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">16 </span><span class="w"></span><span class="err">$</span><span class="n">ABC$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="p">;</span></pre><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="n">somefunc</span><span class="p">(</span><span class="s1">'S1'</span><span class="p">)</span><span class="w">
</span><span class="p">;</span></pre><pre class="highlight code sh">somefunc<span class="w">
</span>----------<span class="w">
</span><span class="m">1000</span><span class="w">
</span><span class="o">(</span><span class="m">1</span><span class="w"> </span>row<span class="o">)</span></pre></div><div class="step step-level-1" step="5" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="8000" data-y="0" data-z="0"><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">DROP</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">somefunc2</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">nm2</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span><span class="w">
</span><span class="ln"> 2 </span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">somefunc2</span><span class="p">(</span><span class="n">nm1</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="n">nm2</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="w">
</span><span class="ln"> 4 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span><span class="w">
</span><span class="ln"> 5 </span><span class="w"></span><span class="k">DECLARE</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">  </span><span class="n">quantity</span><span class="w"> </span><span class="nb">integer</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w">
</span><span class="ln"> 7 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">qty</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">quantity</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">sn</span><span class="o">=</span><span class="n">nm1</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">pn</span><span class="o">=</span><span class="n">nm2</span><span class="p">;</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">  </span><span class="n">RAISE</span><span class="w"> </span><span class="n">NOTICE</span><span class="w"> </span><span class="s1">'Quantity here is %'</span><span class="p">,</span><span class="w"> </span><span class="n">quantity</span><span class="p">;</span><span class="w">
</span><span class="ln">10 </span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="n">quantity</span><span class="p">;</span><span class="w">
</span><span class="ln">11 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">12 </span><span class="w"></span><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="p">;</span></pre></div><div class="step step-level-1" step="6" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="9600" data-y="0" data-z="0"><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">somefunc03</span><span class="p">(</span><span class="n">nm1</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="n">nm2</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w">
</span><span class="ln"> 2 </span><span class="w">   </span><span class="n">o1</span><span class="w"> </span><span class="k">OUT</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">)</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span><span class="w">
</span><span class="ln"> 4 </span><span class="w"></span><span class="k">DECLARE</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="n">quantity</span><span class="w"> </span><span class="nb">integer</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w">
</span><span class="ln"> 6 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">qty</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">quantity</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">sn</span><span class="o">=</span><span class="n">nm1</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">pn</span><span class="o">=</span><span class="n">nm2</span><span class="p">;</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">  </span><span class="c1">-- RAISE NOTICE 'Quantity here is %', quantity;
</span><span class="ln"> 9 </span><span class="c1"></span><span class="w">  </span><span class="n">o1</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">quantity</span><span class="p">;</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">11 </span><span class="w"></span><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="p">;</span></pre></div><div class="step step-level-1" step="7" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="11200" data-y="0" data-z="0"><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">test03</span><span class="p">()</span><span class="w"> </span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$</span><span class="n">ABC$</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">DECLARE</span><span class="w">
</span><span class="ln"> 3 </span><span class="w">  </span><span class="n">quantity</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">  </span><span class="n">q2</span><span class="w">  </span><span class="nb">INTEGER</span><span class="w">  </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="n">snp</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="s1">'S1'</span><span class="p">;</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">  </span><span class="n">pnp</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="s1">'P1'</span><span class="p">;</span><span class="w">
</span><span class="ln"> 7 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">  </span><span class="c1">-- RAISE NOTICE 'Quantity here is %', quantity; -- Prints 30
</span><span class="ln"> 9 </span><span class="c1"></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">somefunc03</span><span class="p">(</span><span class="n">snp</span><span class="p">,</span><span class="w"> </span><span class="n">pnp</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">);</span><span class="w">
</span><span class="ln">10 </span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="n">q2</span><span class="p">;</span><span class="w">
</span><span class="ln">11 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">12 </span><span class="w"></span><span class="err">$</span><span class="n">ABC$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="p">;</span></pre></div><div class="step step-level-1" step="8" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="12800" data-y="0" data-z="0"><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">DROP</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">somefunc04</span><span class="p">(</span><span class="n">nm1</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="p">;</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">somefunc04</span><span class="p">(</span><span class="n">nm1</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="k">SETOF</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span><span class="w">
</span><span class="ln"> 4 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="k">IF</span><span class="w"> </span><span class="n">nm1</span><span class="o">=</span><span class="s1">'S1'</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">RETURN</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">sn</span><span class="o">=</span><span class="s1">'S2'</span><span class="p">;</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">  </span><span class="k">ELSE</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">    </span><span class="k">RETURN</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">sn</span><span class="o">=</span><span class="n">nm1</span><span class="w"> </span><span class="p">;</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">  </span><span class="k">END</span><span class="w"> </span><span class="k">IF</span><span class="p">;</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">11 </span><span class="w"></span><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="p">;</span></pre></div><div class="step step-level-1" step="9" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="14400" data-y="0" data-z="0"><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">DROP</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">somefunc05</span><span class="p">(</span><span class="n">nm1</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">nm2</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">somefunc05</span><span class="p">(</span><span class="n">nm1</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">nm2</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="k">SETOF</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span><span class="w">
</span><span class="ln"> 4 </span><span class="w"></span><span class="k">DECLARE</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="n">i</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w">
</span><span class="ln"> 6 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">  </span><span class="n">LOOP</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">    </span><span class="k">CASE</span><span class="w"> </span><span class="n">i</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">      </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="ln">10 </span><span class="w">        </span><span class="k">RETURN</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">sn</span><span class="o">=</span><span class="s1">'S2'</span><span class="p">;</span><span class="w">
</span><span class="ln">11 </span><span class="w">      </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="ln">12 </span><span class="w">        </span><span class="k">RETURN</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">sn</span><span class="o">=</span><span class="s1">'S3'</span><span class="p">;</span><span class="w">
</span><span class="ln">13 </span><span class="w">      </span><span class="k">ELSE</span><span class="w">
</span><span class="ln">14 </span><span class="w">        </span><span class="k">RETURN</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">pn</span><span class="o">=</span><span class="n">nm2</span><span class="p">);</span><span class="w">
</span><span class="ln">15 </span><span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">CASE</span><span class="p">;</span><span class="w">
</span><span class="ln">16 </span><span class="w">    </span><span class="n">i</span><span class="p">:</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="w">
</span><span class="ln">17 </span><span class="w">    </span><span class="n">EXIT</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">i</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">;</span><span class="w">
</span><span class="ln">18 </span><span class="w">  </span><span class="k">END</span><span class="w"> </span><span class="n">LOOP</span><span class="p">;</span><span class="w">
</span><span class="ln">19 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">20 </span><span class="w"></span><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="p">;</span></pre><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="n">somefunc05</span><span class="p">(</span><span class="s1">'S1'</span><span class="p">,</span><span class="w"> </span><span class="s1">'P1'</span><span class="p">);</span></pre><pre class="highlight code sh">somefunc05<span class="w">
</span>---------------------------------<span class="w">
 </span><span class="o">(</span><span class="s2">"S1        "</span>,<span class="s2">"P1        "</span>,300<span class="o">)</span><span class="w">
 </span><span class="o">(</span><span class="s2">"S2        "</span>,<span class="s2">"P1        "</span>,300<span class="o">)</span><span class="w">
 </span><span class="o">(</span><span class="s2">"S2        "</span>,<span class="s2">"P1        "</span>,300<span class="o">)</span><span class="w">
 </span><span class="o">(</span><span class="s2">"S2        "</span>,<span class="s2">"P2        "</span>,400<span class="o">)</span><span class="w">
 </span><span class="o">(</span><span class="s2">"S3        "</span>,<span class="s2">"P2        "</span>,200<span class="o">)</span><span class="w">
</span><span class="o">(</span><span class="m">5</span><span class="w"> </span>rows<span class="o">)</span></pre></div><div class="step step-level-1" step="10" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="16000" data-y="0" data-z="0"><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">DROP</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">somefunc05_3</span><span class="p">(</span><span class="n">nm2</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">somefunc05_3</span><span class="p">(</span><span class="n">nm2</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="k">SETOF</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span><span class="w">
</span><span class="ln"> 4 </span><span class="w"></span><span class="k">DECLARE</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="n">i</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w">
</span><span class="ln"> 6 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">  </span><span class="c1">--RETURN QUERY SELECT * from sp where sn='S2';
</span><span class="ln"> 8 </span><span class="c1"></span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">sn</span><span class="o">=</span><span class="s1">'S3'</span><span class="p">;</span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="p">;</span></pre><pre class="highlight code sh"><span class="k">select</span><span class="w"> </span>somefunc05_3<span class="o">(</span><span class="s1">'s2'</span><span class="o">)</span><span class="p">;</span><span class="w">
          </span>somefunc05_3<span class="w">
</span>---------------------------------<span class="w">
 </span><span class="o">(</span><span class="s2">"s3        "</span>,<span class="s2">"p2        "</span>,200<span class="o">)</span><span class="w">
</span><span class="o">(</span><span class="m">1</span><span class="w"> </span>row<span class="o">)</span></pre></div><div class="step step-level-1" step="11" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="17600" data-y="0" data-z="0"><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">DROP</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">somefunc05_4</span><span class="p">(</span><span class="n">nm2</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">somefunc05_4</span><span class="p">(</span><span class="n">nm2</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="k">SETOF</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span><span class="w">
</span><span class="ln"> 4 </span><span class="w"></span><span class="k">DECLARE</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="n">i</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w">
</span><span class="ln"> 6 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">  </span><span class="c1">--RETURN QUERY SELECT * from sp where sn='S2';
</span><span class="ln"> 8 </span><span class="c1"></span><span class="w">  </span><span class="c1">--RETURN QUERY SELECT * FROM sp WHERE sn='S3';
</span><span class="ln"> 9 </span><span class="c1"></span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">pn</span><span class="o">=</span><span class="n">nm2</span><span class="p">);</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">11 </span><span class="w"></span><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="p">;</span></pre><pre class="highlight code sh"><span class="nv">sp</span><span class="o">=</span><span class="c1"># select somefunc05('S1','P1');
</span><span class="w">           </span>somefunc05<span class="w">
</span>---------------------------------<span class="w">
 </span><span class="o">(</span><span class="s2">"S1        "</span>,<span class="s2">"P1        "</span>,300<span class="o">)</span><span class="w">
 </span><span class="o">(</span><span class="s2">"S2        "</span>,<span class="s2">"P1        "</span>,300<span class="o">)</span><span class="w">
 </span><span class="o">(</span><span class="s2">"S2        "</span>,<span class="s2">"P1        "</span>,300<span class="o">)</span><span class="w">
 </span><span class="o">(</span><span class="s2">"S2        "</span>,<span class="s2">"P2        "</span>,400<span class="o">)</span><span class="w">
 </span><span class="o">(</span><span class="s2">"S3        "</span>,<span class="s2">"P2        "</span>,200<span class="o">)</span><span class="w">
</span><span class="o">(</span><span class="m">5</span><span class="w"> </span>rows<span class="o">)</span></pre></div><div class="step step-level-1" step="12" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="19200" data-y="0" data-z="0"><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">DROP</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">somefunc05_5</span><span class="p">(</span><span class="n">nm2</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">somefunc05_5</span><span class="p">(</span><span class="n">nm2</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="k">SETOF</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span><span class="w">
</span><span class="ln"> 4 </span><span class="w"></span><span class="k">DECLARE</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="n">i</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w">
</span><span class="ln"> 6 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">sn</span><span class="o">=</span><span class="s1">'S2'</span><span class="p">;</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">sn</span><span class="o">=</span><span class="s1">'S3'</span><span class="p">;</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">pn</span><span class="o">=</span><span class="n">nm2</span><span class="p">;</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">11 </span><span class="w"></span><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="p">;</span></pre><pre class="highlight code sh"><span class="nv">sp</span><span class="o">=</span><span class="c1"># select somefunc05('S1','P1');
</span><span class="w">           </span>somefunc05<span class="w">
</span>---------------------------------<span class="w">
 </span><span class="o">(</span><span class="s2">"S1        "</span>,<span class="s2">"P1        "</span>,300<span class="o">)</span><span class="w">
 </span><span class="o">(</span><span class="s2">"S2        "</span>,<span class="s2">"P1        "</span>,300<span class="o">)</span><span class="w">
 </span><span class="o">(</span><span class="s2">"S2        "</span>,<span class="s2">"P1        "</span>,300<span class="o">)</span><span class="w">
 </span><span class="o">(</span><span class="s2">"S2        "</span>,<span class="s2">"P2        "</span>,400<span class="o">)</span><span class="w">
 </span><span class="o">(</span><span class="s2">"S3        "</span>,<span class="s2">"P2        "</span>,200<span class="o">)</span><span class="w">
</span><span class="o">(</span><span class="m">5</span><span class="w"> </span>rows<span class="o">)</span></pre></div><div class="step step-level-1" step="13" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="20800" data-y="0" data-z="0"><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">DROP</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">sf06</span><span class="p">()</span><span class="w"> </span><span class="p">;</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">sf06</span><span class="p">()</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="k">SETOF</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span><span class="w">
</span><span class="ln"> 4 </span><span class="w"></span><span class="k">DECLARE</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="n">i</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">  </span><span class="n">r</span><span class="w"> </span><span class="n">sp</span><span class="o">%</span><span class="n">rowtype</span><span class="p">;</span><span class="w">
</span><span class="ln"> 7 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">  </span><span class="k">FOR</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="n">LOOP</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">    </span><span class="k">CASE</span><span class="w"> </span><span class="n">i</span><span class="w">
</span><span class="ln">10 </span><span class="w">      </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="ln">11 </span><span class="w">        </span><span class="k">RETURN</span><span class="w"> </span><span class="k">NEXT</span><span class="w"> </span><span class="n">r</span><span class="p">;</span><span class="w">
</span><span class="ln">12 </span><span class="w">      </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="ln">13 </span><span class="w">        </span><span class="k">RETURN</span><span class="w"> </span><span class="k">NEXT</span><span class="w"> </span><span class="n">r</span><span class="p">;</span><span class="w">
</span><span class="ln">14 </span><span class="w">      </span><span class="k">ELSE</span><span class="w">
</span><span class="ln">15 </span><span class="w">        </span><span class="k">RETURN</span><span class="w"> </span><span class="k">NEXT</span><span class="w"> </span><span class="n">r</span><span class="p">;</span><span class="w">
</span><span class="ln">16 </span><span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">CASE</span><span class="p">;</span><span class="w">
</span><span class="ln">17 </span><span class="w">    </span><span class="n">i</span><span class="p">:</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="w">
</span><span class="ln">18 </span><span class="w">    </span><span class="n">EXIT</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">i</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">;</span><span class="w">
</span><span class="ln">19 </span><span class="w">  </span><span class="k">END</span><span class="w"> </span><span class="n">LOOP</span><span class="p">;</span><span class="w">
</span><span class="ln">20 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">21 </span><span class="w"></span><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="p">;</span></pre><pre class="highlight code sh"><span class="nv">sp</span><span class="o">=</span><span class="c1"># \i simple.function.06.sql
</span>CREATE<span class="w"> </span>FUNCTION<span class="w">
</span><span class="nv">sp</span><span class="o">=</span><span class="c1"># select * from sf06('S1','P1');
</span><span class="w">    </span>sno<span class="w">     </span><span class="p">|</span><span class="w">    </span>pno<span class="w">     </span><span class="p">|</span><span class="w"> </span>qty<span class="w">
</span>------------+------------+-----<span class="w">
 </span>S1<span class="w">         </span><span class="p">|</span><span class="w"> </span>P1<span class="w">         </span><span class="p">|</span><span class="w"> </span><span class="m">300</span><span class="w">
 </span>S1<span class="w">         </span><span class="p">|</span><span class="w"> </span>P2<span class="w">         </span><span class="p">|</span><span class="w"> </span><span class="m">200</span><span class="w">
 </span>S1<span class="w">         </span><span class="p">|</span><span class="w"> </span>P3<span class="w">         </span><span class="p">|</span><span class="w"> </span><span class="m">400</span><span class="w">
</span><span class="o">(</span><span class="m">3</span><span class="w"> </span>rows<span class="o">)</span></pre></div><div class="step step-level-1 t2c" step="14" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="22400" data-y="0" data-z="0"><h1 id="simple-functions-1">Simple Functions 1</h1><pre class="highlight code sql"><span class="ln">1 </span><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">get_year</span><span class="p">(</span><span class="nb">INTEGER</span><span class="p">)</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln">5 </span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="err">$</span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">10000</span><span class="p">);</span><span class="w">
</span><span class="ln">6 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">7 </span><span class="w"></span><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="w">
</span><span class="ln">8 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">INPUT</span><span class="p">;</span></pre><pre class="highlight code sql"><span class="ln">1 </span><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">get_month</span><span class="p">(</span><span class="nb">INTEGER</span><span class="p">)</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln">5 </span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="err">$</span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w">
</span><span class="ln">6 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">7 </span><span class="w"></span><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="w">
</span><span class="ln">8 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">INPUT</span><span class="p">;</span></pre><pre class="highlight code sql"><span class="ln">1 </span><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">get_day</span><span class="p">(</span><span class="nb">INTEGER</span><span class="p">)</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln">5 </span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="err">$</span><span class="mi">1</span><span class="w">  </span><span class="o">%</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="p">;</span><span class="w">
</span><span class="ln">6 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">7 </span><span class="w"></span><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="w">
</span><span class="ln">8 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">INPUT</span><span class="p">;</span></pre><pre class="highlight code sql"><span class="ln">1 </span><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w">
</span><span class="ln">2 </span><span class="w"></span><span class="n">get_year_and_month</span><span class="p">(</span><span class="nb">INTEGER</span><span class="p">)</span><span class="w">
</span><span class="ln">3 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span><span class="w">
</span><span class="ln">4 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln">5 </span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="err">$</span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">100</span><span class="p">);</span><span class="w">
</span><span class="ln">6 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">7 </span><span class="w"></span><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="w">
</span><span class="ln">8 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">INPUT</span><span class="p">;</span></pre></div><div class="step step-level-1" step="15" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="24000" data-y="0" data-z="0"><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">convert_int_date_to_varchar10</span><span class="p">(</span><span class="nb">integer</span><span class="p">)</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$</span><span class="n">BODY$</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="err">$</span><span class="mi">1</span><span class="p">::</span><span class="nb">text</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">'-'</span><span class="w"> </span><span class="o">||</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">    </span><span class="k">substring</span><span class="p">(</span><span class="err">$</span><span class="mi">1</span><span class="p">::</span><span class="nb">text</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">'-'</span><span class="w"> </span><span class="o">||</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">    </span><span class="k">substring</span><span class="p">(</span><span class="err">$</span><span class="mi">1</span><span class="p">::</span><span class="nb">text</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">)::</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w">
</span><span class="ln"> 7 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln"> 8 </span><span class="w"></span><span class="err">$</span><span class="n">BODY$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">INPUT</span><span class="p">;</span></pre></div><div class="step step-level-1" step="16" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="25600" data-y="0" data-z="0"><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">uniform_text_jdatei4search</span><span class="p">(</span><span class="nb">text</span><span class="p">)</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$</span><span class="n">BODY$</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">DECLARE</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">  </span><span class="n">lmy_str1</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w">
</span><span class="ln"> 5 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">  </span><span class="n">lmy_str1</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="err">$</span><span class="mi">1</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="s1">'^[0-9]+'</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">  </span><span class="k">IF</span><span class="w"> </span><span class="k">character_length</span><span class="p">(</span><span class="n">lmy_str1</span><span class="p">)</span><span class="o">=</span><span class="mi">8</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">    </span><span class="k">RETURN</span><span class="w"> </span><span class="p">(</span><span class="k">substring</span><span class="p">(</span><span class="n">lmy_str1</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">'-'</span><span class="w"> </span><span class="o">||</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">        </span><span class="k">substring</span><span class="p">(</span><span class="n">lmy_str1</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">'-'</span><span class="w"> </span><span class="o">||</span><span class="w">
</span><span class="ln">10 </span><span class="w">        </span><span class="k">substring</span><span class="p">(</span><span class="n">lmy_str1</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">)::</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w">
</span><span class="ln">11 </span><span class="w">  </span><span class="n">ELSEIF</span><span class="w"> </span><span class="k">character_length</span><span class="p">(</span><span class="n">lmy_str1</span><span class="p">)</span><span class="o">=</span><span class="mi">6</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="ln">12 </span><span class="w">    </span><span class="k">RETURN</span><span class="w"> </span><span class="p">(</span><span class="k">substring</span><span class="p">(</span><span class="n">lmy_str1</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">'-'</span><span class="w"> </span><span class="o">||</span><span class="w">
</span><span class="ln">13 </span><span class="w">        </span><span class="k">substring</span><span class="p">(</span><span class="n">lmy_str1</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">)::</span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w">
</span><span class="ln">14 </span><span class="w">  </span><span class="k">END</span><span class="w"> </span><span class="k">IF</span><span class="p">;</span><span class="w">
</span><span class="ln">15 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">16 </span><span class="w"></span><span class="err">$</span><span class="n">BODY$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="w">
</span><span class="ln">17 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">INPUT</span><span class="p">;</span></pre></div><div class="step step-level-1" step="17" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="27200" data-y="0" data-z="0"><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">composit_idate</span><span class="p">(</span><span class="nb">text</span><span class="p">,</span><span class="nb">integer</span><span class="p">)</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$</span><span class="n">BODY$</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">DECLARE</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">  </span><span class="n">lmy_astr1</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">;</span><span class="w">
</span><span class="ln"> 5 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln"> 6 </span><span class="w">  </span><span class="n">lmy_astr1</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">regexp_split_to_array</span><span class="p">(</span><span class="err">$</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="s1">'\$\@'</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">  </span><span class="c1">--RAISE NOTICE 'values are %', lmy_astr1[1];
</span><span class="ln"> 8 </span><span class="c1"></span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="n">lmy_astr1</span><span class="p">[</span><span class="err">$</span><span class="mi">2</span><span class="p">];</span><span class="w">
</span><span class="ln"> 9 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">10 </span><span class="w"></span><span class="err">$</span><span class="n">BODY$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="w">
</span><span class="ln">11 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">INPUT</span><span class="p">;</span></pre></div><div class="step step-level-1" step="18" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="28800" data-y="0" data-z="0"><pre class="highlight code sql"><span class="ln"> 1 </span><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">is_leap_year</span><span class="p">(</span><span class="nb">INTEGER</span><span class="p">)</span><span class="w">
</span><span class="ln"> 2 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span><span class="w">
</span><span class="ln"> 3 </span><span class="w"></span><span class="k">DECLARE</span><span class="w">
</span><span class="ln"> 4 </span><span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">;</span><span class="w">
</span><span class="ln"> 5 </span><span class="w">  </span><span class="n">leap</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">;</span><span class="w">
</span><span class="ln"> 6 </span><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span><span class="ln"> 7 </span><span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="err">$</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2346</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2820</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">128</span><span class="w"> </span><span class="p">;</span><span class="w">
</span><span class="ln"> 8 </span><span class="w">  </span><span class="k">IF</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">21</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">29</span><span class="w"> </span><span class="k">OR</span><span class="w">
</span><span class="ln"> 9 </span><span class="w">     </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">34</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">38</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="w">  </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">46</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">54</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">58</span><span class="w"> </span><span class="k">OR</span><span class="w">
</span><span class="ln">10 </span><span class="w">     </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">62</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">67</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">71</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">75</span><span class="w">  </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">79</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">83</span><span class="w"> </span><span class="k">OR</span><span class="w">
</span><span class="ln">11 </span><span class="w">     </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">87</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">91</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">95</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">104</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">108</span><span class="w"> </span><span class="k">OR</span><span class="w">
</span><span class="ln">12 </span><span class="w">     </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">112</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">116</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">120</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">124</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="ln">13 </span><span class="w">    </span><span class="n">leap</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span><span class="ln">14 </span><span class="w">  </span><span class="k">ELSE</span><span class="w">
</span><span class="ln">15 </span><span class="w">    </span><span class="n">leap</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">
</span><span class="ln">16 </span><span class="w">  </span><span class="k">END</span><span class="w"> </span><span class="k">IF</span><span class="p">;</span><span class="w">
</span><span class="ln">17 </span><span class="w">  </span><span class="k">RETURN</span><span class="w"> </span><span class="n">leap</span><span class="w"> </span><span class="p">;</span><span class="w">
</span><span class="ln">18 </span><span class="w"></span><span class="k">END</span><span class="p">;</span><span class="w">
</span><span class="ln">19 </span><span class="w"></span><span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="w">
</span><span class="ln">20 </span><span class="w"></span><span class="k">RETURNS</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">INPUT</span><span class="p">;</span></pre></div><div class="step step-level-1" step="19" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="30400" data-y="0" data-z="0"><h1 id="related">Related</h1><ul><li><a href="http://www.postgresql.org/docs/9.5/static/sql-createfunction.html">http://www.postgresql.org/docs/9.5/static/sql-createfunction.html</a></li><li><a href="http://stackoverflow.com/questions/30782925/postgresql-how-to-drop-function-if-exists-without-specifying-parameters">http://stackoverflow.com/questions/30782925/postgresql-how-to-drop-function-if-exists-without-specifying-parameters</a></li><li><a href="http://stackoverflow.com/questions/30782925/postgresql-how-to-drop-function-if-exists-without-specifying-parameters">http://stackoverflow.com/questions/30782925/postgresql-how-to-drop-function-if-exists-without-specifying-parameters</a></li><li><a href="https://github.com/malimome/pgsql-jalalical/blob/master/install/pdate.source">https://github.com/malimome/pgsql-jalalical/blob/master/install/pdate.source</a></li><li><a href="https://gist.github.com/ilius">https://gist.github.com/ilius</a></li><li><a href="https://stackoverflow.com/questions/52436973/postgresql-does-postgresql-support-persian-calendar">https://stackoverflow.com/questions/52436973/postgresql-does-postgresql-support-persian-calendar</a></li></ul></div></div><div id="slide-number" class="slide-number">
         1
      </div><script type="text/javascript" src="js/impress.js"></script><script type="text/javascript" src="js/gotoSlide.js"></script><script type="text/javascript" src="js/hovercraft.js"></script><script type="text/javascript" src="js/MathJax/es5/tex-mml-chtml.js"></script><script type="text/javascript">
      document.getElementById("impress").addEventListener("impress:stepenter", update_slide_number, false);
    </script></body></html>