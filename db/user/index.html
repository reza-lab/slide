<html xmlns="http://www.w3.org/1999/xhtml"><head><title></title><meta charset="UTF-8"><meta name="generator" content="bildumilo 1.0 https://github.com/yoosofan/bildumilo"><link rel="stylesheet" href="css/hovercraft.css" media="all"><link rel="stylesheet" href="css/highlight.css" media="all"><link rel="stylesheet" href="css/style.css" media="all"><script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        showProcessingMessages: false,
        messageStyle: "none",
        TeX : { extensions : ['color.js'] }
      });
    </script></head><body class="impress-not-supported"><div id="impress" data-width="1024" data-height="768" data-transition-duration="1000"><div class="step step-level-1" step="0" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="0" data-z="0"><h1 id="database-users">Database users</h1><h2 id="user-authentication">User Authentication</h2><p>Ahmad Yoosofan</p><p>Database course</p><p>University of Kashan, Spring 2021</p></div><div class="step step-level-1" step="1" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="1600" data-y="0" data-z="0"><img src="img/several_users.png"></div><div class="step step-level-1" step="2" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="3200" data-y="0" data-z="0"><h1 id="users-in-general">Users in general</h1><p>Application users</p></div><div class="step step-level-1" step="3" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="4800" data-y="0" data-z="0"><h1 id="tier-architecture">2 tier architecture</h1><img src="img/aplication_user.gif"></div><div class="step step-level-1" step="4" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="6400" data-y="0" data-z="0"><h1 id="tier-architecture-1">3 tier architecture</h1><img src="img/3-tier-architecture_W640.jpg"></div><div class="step step-level-1" step="5" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="8000" data-y="0" data-z="0"><h1 id="vs-3-tier-architecture">2 vs 3 tier architecture</h1><img src="img/2_3_tier_architecture.jpg"></div><div class="step step-level-1" step="6" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="9600" data-y="0" data-z="0"><h1 id="tier-architecture-2">3 tier architecture</h1><img src="img/A_Typical_3_Tier_Server_Architecture.jpg"></div><div class="step step-level-1" step="7" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="11200" data-y="0" data-z="0"><h1 id="n-tier-architecture">N-tier_architecture</h1><img src="img/N-tier_architecture.png"></div><div class="step step-level-1" step="8" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="12800" data-y="0" data-z="0"><h1 id="type-of-users-i">Type of Users(I)</h1><ul><li class="substep">Application Programmers</li><li class="substep">Sophisticated Users</li><li class="substep">Stand-alone Users</li><li class="substep">Native Users</li></ul></div><div class="step step-level-1" step="9" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="14400" data-y="0" data-z="0"><h1 id="type-of-users-ii">Type of Users(II)</h1><ul><li class="substep"><em>application programmer</em>: user who implements specific application programs to access the stored data</li><li class="substep"><em>application user</em>: accesses an existing application program to perform daily tasks.</li><li class="substep"><em>database administrator (DBA)</em>: responsible for authorizing access to the database, monitoring its use and managing all the resources to support the use of the entire database system</li><li class="substep"><em>end user</em>: people whose jobs require access to a database for querying, updating and generating reports</li><li class="substep"><em>sophisticated user</em>: those who use other methods, other than the application program, to access the database</li></ul></div><div class="step step-level-1" step="10" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="16000" data-y="0" data-z="0"><h1 id="database-administrators">Database Administrators</h1><ul><li class="substep">Installing and upgrading the DBMS Servers</li><li class="substep">Design and implementation:</li><li class="substep">Performance tuning:</li><li class="substep">Migrate database servers</li><li class="substep">Backup and Recovery:</li><li class="substep">Security</li><li class="substep">Documentation</li></ul></div><div class="step step-level-1" step="11" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="17600" data-y="0" data-z="0"><h1 id="postgresql">PostgreSQl</h1><h2 id="ubuntu">Ubuntu</h2><pre class="highlight code sh">sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>postgresql<span class="w"> </span>postgresql-contrib<span class="w"> </span>libpq-dev<span class="w">
</span>apt-cache<span class="w"> </span>search<span class="w"> </span>postgres<span class="w">
</span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>pgadmin3<span class="w">
</span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libecpg-dev<span class="w"> </span><span class="c1"># Embedded PostgreSQL for C
# sudo apt install ecpg-xc # old</span></pre><h2 id="change-password">Change Password</h2><pre class="highlight code sh">sudo<span class="w"> </span>-u<span class="w"> </span>postgres<span class="w"> </span>psql<span class="w"> </span><span class="nv">postgres</span><span class="w">

</span><span class="o">=</span><span class="c1">#\password postgres
</span><span class="o">=</span><span class="c1">#\q</span></pre></div><div class="step step-level-1" step="12" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="19200" data-y="0" data-z="0"><h1 id="connect-to-database">Connect to database</h1><pre class="highlight code sql"><span class="n">psql</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">postgres</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="n">postgres</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="w">
</span><span class="n">psql</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">postgres</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="n">postgres</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="n">W</span><span class="w">
</span><span class="n">psql</span><span class="w"> </span><span class="c1">--user=postgres --host='127.0.0.1' --password
</span><span class="n">psql</span><span class="w"> </span><span class="c1">--db=psql --user=postgres --host='127.0.0.1' --password</span></pre><p>Or run</p><p>pgadmin3</p><p>File --&gt; Add Server</p><ul><li>name: whatever you want. for example "myDB"</li><li>Host: 127.0.0.1</li><li>Password:  (You already assign a password for connecting to this database.)</li></ul></div><div class="step step-level-1" step="13" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="20800" data-y="0" data-z="0"><p>Create users in PostgreSQL</p><pre class="highlight code sql"><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="n">ali</span><span class="p">;</span><span class="w"> </span><span class="c1">-- &#1587;&#1575;&#1582;&#1578; &#1705;&#1575;&#1585;&#1576;&#1585; &#1593;&#1604;&#1740;
</span><span class="k">DROP</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="n">ali</span><span class="p">;</span><span class="w"> </span><span class="c1">-- &#1581;&#1584;&#1601; &#1705;&#1575;&#1585;&#1576;&#1585; &#1593;&#1604;&#1740;
</span><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="n">ali</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">'1234'</span><span class="p">;</span><span class="w">
</span><span class="c1">-- &#1587;&#1575;&#1582;&#1578; &#1705;&#1575;&#1585;&#1576;&#1585; &#1593;&#1604;&#1740; &#1576;&#1575; &#1585;&#1605;&#1586; 1234
</span><span class="k">DROP</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="n">ali</span><span class="p">;</span><span class="w">
</span><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="n">ali</span><span class="w"> </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">'1234'</span><span class="p">;</span><span class="w">
</span><span class="c1">-- &#1587;&#1575;&#1582;&#1578; &#1705;&#1575;&#1585;&#1576;&#1585; &#1576;&#1575; &#1585;&#1605;&#1586;
</span><span class="k">DROP</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="n">ali</span><span class="p">;</span><span class="w">
</span><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="n">ali</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">SUPERUSER</span><span class="w">  </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">'1234'</span><span class="p">;</span><span class="w">
</span><span class="c1">--&#1583;&#1585; &#1575;&#1740;&#1606;&#1580;&#1575; SUPERUSER &#1740;&#1593;&#1606;&#1740; &#1705;&#1575;&#1585;&#1576;&#1585; &#1583;&#1585; &#1587;&#1591;&#1581; &#1605;&#1583;&#1740;&#1585; &#1587;&#1575;&#1605;&#1575;&#1606;&#1607;&#8204;&#1740; &#1662;&#1575;&#1740;&#1711;&#1575;&#1607; &#1583;&#1575;&#1583;&#1607; &#1575;&#1587;&#1578;.</span></pre></div><div class="step step-level-1" step="14" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="22400" data-y="0" data-z="0"><pre class="highlight code sql"><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="n">ali</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">NOSUPERUSER</span><span class="w">  </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">'1234'</span><span class="p">;</span><span class="w">
</span><span class="c1">-- &#1583;&#1585; &#1575;&#1740;&#1606;&#1580;&#1575; NO &#1740;&#1593;&#1606;&#1740; &#1705;&#1575;&#1585;&#1576;&#1585; &#1594;&#1740;&#1585; &#1605;&#1583;&#1740;&#1585;
</span><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="n">ali</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">SUPERUSER</span><span class="w"> </span><span class="k">CREATEDB</span><span class="w"> </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">'1234'</span><span class="p">;</span><span class="w">
</span><span class="c1">-- &#1575;&#1605;&#1705;&#1575;&#1606; &#1587;&#1575;&#1582;&#1578; &#1662;&#1575;&#1740;&#1711;&#1575;&#1607; &#1583;&#1575;&#1583;&#1607; &#1576;&#1585;&#1575;&#1740; &#1575;&#1740;&#1606; &#1705;&#1575;&#1585;&#1576;&#1585; &#1608;&#1580;&#1608;&#1583; &#1583;&#1575;&#1585;&#1583; CREATEDB
</span><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="n">ali</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">NOSUPERUSER</span><span class="w"> </span><span class="k">NOCREATEDB</span><span class="w"> </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">'1234'</span><span class="p">;</span><span class="w">
</span><span class="c1">-- &#1575;&#1605;&#1705;&#1575;&#1606; &#1587;&#1575;&#1582;&#1578; &#1662;&#1575;&#1740;&#1711;&#1575;&#1607; &#1583;&#1575;&#1583;&#1607; &#1576;&#1585;&#1575;&#1740; &#1575;&#1740;&#1606; &#1705;&#1575;&#1585;&#1576;&#1585; &#1608;&#1580;&#1608;&#1583; &#1606;&#1583;&#1575;&#1585;&#1583; NOCREATEDB
</span><span class="w">

</span><span class="c1">---------------- DCL (Data Control Language)   ----------------
</span><span class="w">
</span><span class="k">GRANT</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">PRIVILEGES</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="ss">"test_database"</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">tester</span><span class="p">;</span><span class="w">
</span><span class="c1">-- &#1607;&#1605;&#1607;&#8204;&#1740; &#1605;&#1580;&#1608;&#1586;&#1607;&#1575; &#1576;&#1607; &#1705;&#1575;&#1585;&#1576;&#1585; tester &#1576;&#1585; &#1585;&#1608;&#1740; &#1662;&#1575;&#1740;&#1711;&#1575;&#1607; &#1583;&#1575;&#1583;&#1607;&#8204;&#1740; test_database &#1583;&#1575;&#1583;&#1607; &#1605;&#1740;&#8204;&#1588;&#1608;&#1583;.</span></pre></div><div class="step step-level-1" step="15" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="24000" data-y="0" data-z="0"><pre class="highlight code sql substep"><span class="k">GRANT</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">PRIVILEGES</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">spd</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">ali</span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="k">REVOKE</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">PRIVILEGES</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">spd</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ali</span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="k">GRANT</span><span class="w"> </span><span class="k">INSERT</span><span class="p">,</span><span class="w"> </span><span class="k">UPDATE</span><span class="p">,</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">ali</span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="k">REVOKE</span><span class="w"> </span><span class="k">INSERT</span><span class="p">,</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ali</span><span class="p">;</span></pre><pre class="highlight code sql substep"><span class="k">REVOKE</span><span class="w"> </span><span class="k">INSERT</span><span class="p">,</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ali</span><span class="w"> </span><span class="k">CASCADE</span><span class="w"> </span><span class="p">;</span></pre></div><div class="step step-level-1" step="16" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="25600" data-y="0" data-z="0"><h1 id="grant">&#1587;&#1575;&#1582;&#1578;&#1575;&#1585; &#1583;&#1587;&#1578;&#1608;&#1585; grant</h1><pre class="highlight code sql"><span class="k">GRANT</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">INSERT</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">RULE</span><span class="w"> </span><span class="o">|</span><span class="w">
          </span><span class="k">REFERENCES</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w">
        </span><span class="err">}</span><span class="w">
    </span><span class="p">[,...]</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="k">PRIVILEGES</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="err">}</span><span class="w">
    </span><span class="k">ON</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="n">tablename</span><span class="w"> </span><span class="p">[,</span><span class="w"> </span><span class="p">...]</span><span class="w">
    </span><span class="k">TO</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="n">groupname</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">PUBLIC</span><span class="w"> </span><span class="err">}</span><span class="w">
    </span><span class="p">[,</span><span class="w"> </span><span class="p">...]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="k">GRANT</span><span class="w"> </span><span class="k">OPTION</span><span class="w"> </span><span class="p">]</span></pre></div><div class="step step-level-1" step="17" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="27200" data-y="0" data-z="0"><h1 id="revoke">&#1587;&#1575;&#1582;&#1578;&#1575;&#1585; &#1583;&#1587;&#1578;&#1608;&#1585; revoke</h1><pre class="highlight code sql"><span class="k">REVOKE</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="k">GRANT</span><span class="w"> </span><span class="k">OPTION</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="err">{</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">INSERT</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">RULE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="err">}</span><span class="w">
</span><span class="p">[,...]</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="k">PRIVILEGES</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="err">}</span><span class="w">
</span><span class="k">ON</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="n">tablename</span><span class="w"> </span><span class="p">[,</span><span class="w"> </span><span class="p">...]</span><span class="w">
</span><span class="k">FROM</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="n">groupname</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">PUBLIC</span><span class="w"> </span><span class="err">}</span><span class="w"> </span><span class="p">[,</span><span class="w"> </span><span class="p">...]</span><span class="w">
</span><span class="p">[</span><span class="w"> </span><span class="k">CASCADE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">RESTRICT</span><span class="w"> </span><span class="p">]</span></pre></div><div class="step step-level-1" step="18" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="28800" data-y="0" data-z="0"><p>Console postgres</p><pre class="highlight code sh"><span class="sb">`</span><span class="se">\d</span>u<span class="sb">`</span><span class="w">
</span><span class="sb">`</span><span class="se">\d</span>u+<span class="sb">`</span></pre><pre class="highlight code sh">psql<span class="w"> </span>-c<span class="w"> </span><span class="s2">"\du"</span></pre></div><div class="step step-level-1" step="19" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="30400" data-y="0" data-z="0"><h1 id="behind-scene">behind scene</h1><pre class="highlight code sql"><span class="k">SELECT</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">usename</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="ss">"Role name"</span><span class="p">,</span><span class="w">
  </span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">usesuper</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">usecreatedb</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">'superuser, create
database'</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">pg_catalog</span><span class="p">.</span><span class="nb">text</span><span class="p">)</span><span class="w">
       </span><span class="k">WHEN</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">usesuper</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">'superuser'</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">pg_catalog</span><span class="p">.</span><span class="nb">text</span><span class="p">)</span><span class="w">
       </span><span class="k">WHEN</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">usecreatedb</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">'create database'</span><span class="w"> </span><span class="k">AS</span><span class="w">
</span><span class="n">pg_catalog</span><span class="p">.</span><span class="nb">text</span><span class="p">)</span><span class="w">
       </span><span class="k">ELSE</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">''</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">pg_catalog</span><span class="p">.</span><span class="nb">text</span><span class="p">)</span><span class="w">
  </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="ss">"Attributes"</span><span class="w">
</span><span class="k">FROM</span><span class="w"> </span><span class="n">pg_catalog</span><span class="p">.</span><span class="n">pg_user</span><span class="w"> </span><span class="n">u</span><span class="w">
</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span></pre></div><div class="step step-level-1" step="20" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="32000" data-y="0" data-z="0"><h1 id="some-commands">Some Commands</h1><p>run sql command in terminal</p><pre class="highlight code console"><span class="go">psql -U username -d mydatabase -c 'SELECT * FROM mytable'

psql -U username -d mydatabase -c 'select pg_terminate_backend(pid)
                                   from pg_stat_activity where datname=dc';</span></pre><pre class="highlight code sql"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">pg_stat_activity</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">datname</span><span class="o">=</span><span class="s1">'dc'</span><span class="w">

</span><span class="n">psql</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="err">$</span><span class="n">database_host</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="err">$</span><span class="n">database_user</span><span class="w">  </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">boot_database_set</span><span class="p">.</span><span class="k">sql</span><span class="w">

</span><span class="k">ALTER</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="n">username</span><span class="w">  </span><span class="k">WITH</span><span class="w"> </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">'password'</span><span class="p">;</span></pre></div><div class="step step-level-1" step="21" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="33600" data-y="0" data-z="0"><h1 id="create-index">Create Index</h1><pre class="highlight code sql"><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">time_index</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">mytable</span><span class="p">(</span><span class="n">time1</span><span class="p">);</span></pre><pre class="highlight code sql"><span class="k">DROP</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">time_index</span><span class="p">;</span></pre><pre class="highlight code sql"><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">time_index2</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">mytable</span><span class="p">(</span><span class="n">time1</span><span class="p">,</span><span class="w"> </span><span class="n">time2</span><span class="p">);</span></pre></div><div class="step step-level-1" step="22" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="35200" data-y="0" data-z="0"><h1 id="backup">Backup</h1><h2 id="dump">Dump</h2><pre class="highlight code sh">pg_dump<span class="w"> </span>--host<span class="o">=</span><span class="s1">'127.0.0.1'</span><span class="w"> </span>--username<span class="o">=</span>postgres<span class="w"> </span>--password<span class="w"> </span>pc<span class="w"> </span>&gt;<span class="w"> </span>backup.tar<span class="w">

</span>pg_dumpall<span class="w">

</span>pg_dumpall<span class="w"> </span>-U<span class="w"> </span>postgres<span class="w"> </span>&gt;<span class="w"> </span>all.sql<span class="w">

</span>pg_dumpall<span class="w"> </span>--schema-only<span class="w"> </span>&gt;<span class="w"> </span>definitiononly.sql<span class="w">

</span>pg_dumpall<span class="w"> </span>--tablespaces-only<span class="w"> </span>&gt;<span class="w"> </span>allroles.sql</pre><h2 id="restore">Restore</h2><pre class="highlight code sh">psql<span class="w"> </span>dbname<span class="w"> </span>&lt;<span class="w"> </span>backup.sql<span class="w">
</span>psql<span class="w"> </span>pc<span class="w"> </span>&lt;<span class="w"> </span>backup.sql</pre></div><div class="step step-level-1" step="23" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="36800" data-y="0" data-z="0"><h1 id="transaction-i">Transaction(I)</h1><p>&#1581;&#1587;&#1575;&#1576; &#1576;&#1575;&#1606;&#1705;&#1740; &#1585;&#1575; &#1583;&#1585; &#1606;&#1592;&#1585; &#1576;&#1711;&#1740;&#1585;&#1740;&#1583; &#1605;&#1740;&#8204;&#1582;&#1608;&#1575;&#1607;&#1740;&#1605; &#1662;&#1608;&#1604;&#1740; &#1585;&#1575; &#1576;&#1607; &#1581;&#1587;&#1575;&#1576; &#1601;&#1585;&#1583; &#1583;&#1740;&#1711;&#1585;&#1740; &#1576;&#1601;&#1585;&#1587;&#1578;&#1740;&#1605;. &#1583;&#1585; &#1587;&#1575;&#1583;&#1607;&#8204;&#1578;&#1585;&#1740;&#1606; &#1581;&#1575;&#1604;&#1578; &#1576;&#1575;&#1740;&#1583; &#1583;&#1608; &#1583;&#1587;&#1578;&#1608;&#1585; &#1576;&#1607; &#1585;&#1608;&#1586; &#1585;&#1587;&#1575;&#1606;&#1740; &#1575;&#1606;&#1581;&#1575;&#1605; &#1588;&#1608;&#1583;.</p><p>&#1575;&#1604;&#1601;. &#1575;&#1586; &#1581;&#1587;&#1575;&#1576; &#1605;&#1606; &#1605;&#1602;&#1583;&#1575;&#1585;&#1740; &#1705;&#1605; &#1576;&#1588;&#1607;</p><p>&#1576;. &#1576;&#1607; &#1581;&#1587;&#1575;&#1576; &#1711;&#1740;&#1585;&#1606;&#1583;&#1607; &#1608;&#1575;&#1585;&#1740;&#1586; &#1576;&#1588;&#1607;</p><p>&#1662;&#1587; &#1583;&#1587;&#1578; &#1705;&#1605; &#1583;&#1608; &#1583;&#1587;&#1578;&#1608;&#1585; update</p><pre class="highlight code sql"><span class="n">member</span><span class="p">(</span><span class="w"> </span><span class="n">ssn_</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">sname</span><span class="p">,</span><span class="w"> </span><span class="n">balance</span><span class="p">)</span></pre></div><div class="step step-level-1" step="24" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="38400" data-y="0" data-z="0"><h1 id="transaction-ii">Transaction(II)</h1><pre class="highlight code sql"><span class="k">BEGIN</span><span class="w"> </span><span class="k">TRANSACTION</span><span class="p">;</span><span class="w">

</span><span class="k">update</span><span class="w"> </span><span class="p">..</span><span class="w">
</span><span class="k">update</span><span class="w"> </span><span class="p">...</span><span class="w">

</span><span class="k">COMMIT</span><span class="p">;</span><span class="w">  </span><span class="c1">----  ROLLBACK</span></pre></div><div class="step step-level-1" step="25" claas="t2c" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="40000" data-y="0" data-z="0"><h1 id="transaction-iii">Transaction(III)</h1><pre class="highlight code sql"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="p">(</span><span class="w">
  </span><span class="n">account_no</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
  </span><span class="n">balance</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="n">account_no</span><span class="p">),</span><span class="w">
             </span><span class="k">CHECK</span><span class="p">(</span><span class="n">balance</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">
</span><span class="p">);</span><span class="w">

</span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">account_changes</span><span class="w"> </span><span class="p">(</span><span class="w">
  </span><span class="n">change_no</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
  </span><span class="n">account_no</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
  </span><span class="n">flag</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
  </span><span class="n">amount</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
  </span><span class="n">changed_at</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
  </span><span class="k">foreign</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="p">(</span><span class="n">account_no</span><span class="p">)</span><span class="w"> </span><span class="k">references</span><span class="w"> </span><span class="n">accounts</span><span class="p">(</span><span class="n">account_no</span><span class="p">)</span><span class="w">
</span><span class="p">);</span></pre><pre class="highlight code sql"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="p">(</span><span class="n">account_no</span><span class="p">,</span><span class="n">balance</span><span class="p">)</span><span class="w">
</span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">20100</span><span class="p">);</span><span class="w">

</span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="p">(</span><span class="n">account_no</span><span class="p">,</span><span class="n">balance</span><span class="p">)</span><span class="w">
</span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">10100</span><span class="p">);</span><span class="w">
</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">accounts</span><span class="p">;</span></pre></div><div class="step step-level-1" step="26" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="41600" data-y="0" data-z="0"><h1 id="transaction-iii-1">Transaction(III)</h1><pre class="highlight code sql"><span class="k">BEGIN</span><span class="w"> </span><span class="k">TRANSACTION</span><span class="p">;</span><span class="w">

</span><span class="k">UPDATE</span><span class="w"> </span><span class="n">accounts</span><span class="w">
   </span><span class="k">SET</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1000</span><span class="w">
</span><span class="k">WHERE</span><span class="w"> </span><span class="n">account_no</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w">

</span><span class="k">UPDATE</span><span class="w"> </span><span class="n">accounts</span><span class="w">
   </span><span class="k">SET</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1000</span><span class="w">
</span><span class="k">WHERE</span><span class="w"> </span><span class="n">account_no</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">200</span><span class="p">;</span><span class="w">

</span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">account_changes</span><span class="p">(</span><span class="n">change_no</span><span class="p">,</span><span class="w"> </span><span class="n">account_no</span><span class="p">,</span><span class="n">flag</span><span class="p">,</span><span class="n">amount</span><span class="p">,</span><span class="n">changed_at</span><span class="p">)</span><span class="w">
</span><span class="k">VALUES</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="s1">'-'</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="n">datetime</span><span class="p">(</span><span class="s1">'now'</span><span class="p">));</span><span class="w">

</span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">account_changes</span><span class="p">(</span><span class="n">change_no</span><span class="p">,</span><span class="w"> </span><span class="n">account_no</span><span class="p">,</span><span class="n">flag</span><span class="p">,</span><span class="n">amount</span><span class="p">,</span><span class="n">changed_at</span><span class="p">)</span><span class="w">
</span><span class="k">VALUES</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="s1">'+'</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="n">datetime</span><span class="p">(</span><span class="s1">'now'</span><span class="p">));</span><span class="w">

</span><span class="k">COMMIT</span><span class="p">;</span><span class="w">

</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">accounts</span><span class="p">;</span></pre></div><div class="step step-level-1" step="27" claas="t2c" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="43200" data-y="0" data-z="0"><h1 id="transaction-iv">Transaction(IV)</h1><pre class="highlight code sql"><span class="k">START</span><span class="w"> </span><span class="k">TRANSACTION</span><span class="p">;</span><span class="w">
</span><span class="k">BEGIN</span><span class="w"> </span><span class="k">TRANSACTION</span><span class="p">;</span><span class="w">
</span><span class="k">BEGIN</span><span class="w"> </span><span class="k">WORK</span><span class="p">;</span><span class="w">
</span><span class="k">BEGIN</span><span class="p">;</span><span class="w">
</span><span class="k">START</span><span class="p">;</span></pre><pre class="highlight code sql"><span class="k">BEGIN</span><span class="p">;</span><span class="w">
  </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">table1</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w">
  </span><span class="n">SAVEPOINT</span><span class="w"> </span><span class="n">my_savepoint</span><span class="p">;</span><span class="w">
  </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">table1</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w">
  </span><span class="k">ROLLBACK</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">SAVEPOINT</span><span class="w"> </span><span class="n">my_savepoint</span><span class="p">;</span><span class="w">
  </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">table1</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w">
</span><span class="k">COMMIT</span><span class="p">;</span></pre><pre class="highlight code sql"><span class="k">BEGIN</span><span class="p">;</span><span class="w">
    </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">table1</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w">
    </span><span class="n">SAVEPOINT</span><span class="w"> </span><span class="n">my_savepoint</span><span class="p">;</span><span class="w">
    </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">table1</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">);</span><span class="w">
    </span><span class="n">RELEASE</span><span class="w"> </span><span class="n">SAVEPOINT</span><span class="w"> </span><span class="n">my_savepoint</span><span class="p">;</span><span class="w">
</span><span class="k">COMMIT</span><span class="p">;</span></pre></div><div class="step step-level-1" step="28" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="44800" data-y="0" data-z="0"><h1 id="commit-postgresql">Commit(PostgreSQL)</h1><pre class="highlight code sh"><span class="se">\s</span>et<span class="w"> </span>AUTOCOMMIT<span class="w"> </span>off<span class="w">
</span><span class="se">\e</span>cho<span class="w"> </span>:AUTOCOMMIT<span class="w">
</span><span class="se">\s</span>et<span class="w"> </span>AUTOCOMMIT<span class="w"> </span>off</pre></div><div class="step step-level-1" step="29" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="46400" data-y="0" data-z="0"><h1 id="acid">ACID</h1><ul><li class="substep"><em>Atomic</em>:</li><li class="substep"><em>Consistent</em>:</li><li class="substep"><em>Isolation</em>:</li><li class="substep"><em>Durable</em>:</li></ul><p>DBMS = DataBase Management System (mySql, postgreSQL, SQL server, mariadb, Oracle, DB2)</p></div><div class="step step-level-1" step="30" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="48000" data-y="0" data-z="0"><h1 id="view">View</h1><p>view</p></div><div class="step step-level-1" step="31" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="49600" data-y="0" data-z="0"><p>&#1581;&#1587;&#1575;&#1576; &#1576;&#1575;&#1606;&#1705;&#1740; &#1585;&#1575; &#1583;&#1585; &#1606;&#1592;&#1585; &#1576;&#1711;&#1740;&#1585;&#1740;&#1583; &#1605;&#1740;&#8204;&#1582;&#1608;&#1575;&#1607;&#1740;&#1605; &#1662;&#1608;&#1604;&#1740; &#1585;&#1575; &#1576;&#1607; &#1581;&#1587;&#1575;&#1576; &#1601;&#1585;&#1583; &#1583;&#1740;&#1711;&#1585;&#1740; &#1576;&#1601;&#1585;&#1587;&#1578;&#1740;&#1605;. &#1583;&#1585; &#1587;&#1575;&#1583;&#1607;&#8204;&#1578;&#1585;&#1740;&#1606; &#1581;&#1575;&#1604;&#1578; &#1576;&#1575;&#1740;&#1583; &#1583;&#1608; &#1583;&#1587;&#1578;&#1608;&#1585; &#1576;&#1607; &#1585;&#1608;&#1586; &#1585;&#1587;&#1575;&#1606;&#1740; &#1575;&#1606;&#1581;&#1575;&#1605; &#1588;&#1608;&#1583;.
&#1575;&#1604;&#1601;. &#1575;&#1586; &#1581;&#1587;&#1575;&#1576; &#1605;&#1606; &#1605;&#1602;&#1583;&#1575;&#1585;&#1740; &#1705;&#1605; &#1576;&#1588;&#1607;
&#1576;. &#1576;&#1607; &#1581;&#1587;&#1575;&#1576; &#1711;&#1740;&#1585;&#1606;&#1583;&#1607; &#1608;&#1575;&#1585;&#1740;&#1586; &#1576;&#1588;&#1607;
&#1662;&#1587; &#1583;&#1587;&#1578; &#1705;&#1605; &#1583;&#1608; &#1583;&#1587;&#1578;&#1608;&#1585; update</p><p>&#1575;&#1604;&#1601; &#1608; &#1576; &#1583;&#1608; &#1583;&#1587;&#1578;&#1608;&#1585; &#1740;&#1575; &#1605;&#1580;&#1605;&#1608;&#1593;&#1607; &#1583;&#1587;&#1578;&#1608;&#1585;&#1607;&#1575;&#1740; &#1605;&#1580;&#1586;&#1575;&#1740; SQL  &#1582;&#1608;&#1575;&#1607;&#1606;&#1583; &#1588;&#1583;.</p><p>insert into S(sn,sname,status,city) values('S1','Smith',20,'London');</p><p>&#1578;&#1585;&#1575;&#1705;&#1606;&#1588; &#1583;&#1587;&#1578;&#1608;&#1585; &#1740;&#1575; &#1605;&#1580;&#1605;&#1608;&#1593;&#1607; &#1583;&#1587;&#1578;&#1608;&#1585;&#1607;&#1575;&#1740;&#1740; &#1607;&#1587;&#1578; &#1705;&#1607; &#1605;&#1740;&#8204;&#1582;&#1608;&#1575;&#1607;&#1740;&#1605; &#1740;&#1575; &#1607;&#1605;&#1607; &#1575;&#1606;&#1580;&#1575;&#1605; &#1588;&#1608;&#1583; &#1740;&#1575; &#1607;&#1740;&#1670; &#1705;&#1583;&#1575;&#1605; &#1575;&#1606;&#1580;&#1575;&#1605; &#1606;&#1588;&#1608;&#1583;. transaction</p><p>Atomic: a transaction should be atomic. It means that a change cannot be broken down into smaller ones. When you commit a transaction, either the entire transaction is applied or not.
Consistent: a transaction must ensure to change the database from one valid state to another. When a transaction starts and executes a statement to modify data, the database becomes inconsistent. However, when the transaction is committed or rolled back, it is important that the transaction must keep the database consistent.
Isolation: a pending transaction performed by a session must be isolated from other sessions. When a session starts a transaction and executes the insert or update statement to change the data, these changes are only visible to the current session, not others. On the other hand, the changes committed by other sessions after the transaction started should not be visible to the current session.
Durable: if a transaction is successfully committed, the changes must be permanent in the database regardless of the condition such as power failure or program crash. On the contrary, if the program crashes before the transaction is committed, the change should not persist.
DBMS = DataBase Management System (mySql, postgreSQL, SQL server, mariadb, Oracle, DB2)</p><p><a href="https://www.sqlitetutorial.net/sqlite-transaction/">https://www.sqlitetutorial.net/sqlite-transaction/</a></p></div><div class="step step-level-1" step="32" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="51200" data-y="0" data-z="0"><pre class="highlight code sql"><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="p">(</span><span class="w">
  </span><span class="n">account_no</span><span class="w"> </span><span class="nb">integer</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w">
  </span><span class="n">balance</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="p">(</span><span class="n">account_no</span><span class="p">),</span><span class="w">
             </span><span class="k">check</span><span class="p">(</span><span class="n">balance</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">
</span><span class="p">);</span><span class="w">

</span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">account_changes</span><span class="w"> </span><span class="p">(</span><span class="w">
  </span><span class="n">change_no</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w">
  </span><span class="n">account_no</span><span class="w"> </span><span class="nb">integer</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w">
  </span><span class="n">flag</span><span class="w"> </span><span class="nb">text</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w">
  </span><span class="n">amount</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w">
  </span><span class="n">changed_at</span><span class="w"> </span><span class="nb">text</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w">
</span><span class="p">);</span></pre></div><div class="step step-level-1" step="33" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="52800" data-y="0" data-z="0"><pre class="highlight code sql"><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="p">(</span><span class="n">account_no</span><span class="p">,</span><span class="n">balance</span><span class="p">)</span><span class="w">
</span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">20100</span><span class="p">);</span><span class="w">

</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="p">(</span><span class="n">account_no</span><span class="p">,</span><span class="n">balance</span><span class="p">)</span><span class="w">
</span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">10100</span><span class="p">);</span><span class="w">
</span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">accounts</span><span class="p">;</span><span class="w">

</span><span class="k">begin</span><span class="w"> </span><span class="k">transaction</span><span class="p">;</span><span class="w">

</span><span class="k">update</span><span class="w"> </span><span class="n">accounts</span><span class="w">
   </span><span class="k">set</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1000</span><span class="w">
 </span><span class="k">where</span><span class="w"> </span><span class="n">account_no</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w">

</span><span class="k">update</span><span class="w"> </span><span class="n">accounts</span><span class="w">
   </span><span class="k">set</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1000</span><span class="w">
 </span><span class="k">where</span><span class="w"> </span><span class="n">account_no</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">200</span><span class="p">;</span><span class="w">
</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">account_changes</span><span class="p">(</span><span class="n">change_no</span><span class="p">,</span><span class="w"> </span><span class="n">account_no</span><span class="p">,</span><span class="n">flag</span><span class="p">,</span><span class="n">amount</span><span class="p">,</span><span class="n">changed_at</span><span class="p">)</span><span class="w">
</span><span class="k">values</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="s1">'-'</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="n">datetime</span><span class="p">(</span><span class="s1">'now'</span><span class="p">));</span></pre><pre class="highlight code sql"><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">account_changes</span><span class="p">(</span><span class="n">change_no</span><span class="p">,</span><span class="w"> </span><span class="n">account_no</span><span class="p">,</span><span class="n">flag</span><span class="p">,</span><span class="n">amount</span><span class="p">,</span><span class="n">changed_at</span><span class="p">)</span><span class="w">
</span><span class="k">values</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="s1">'+'</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="n">datetime</span><span class="p">(</span><span class="s1">'now'</span><span class="p">));</span><span class="w">

</span><span class="k">COMMIT</span><span class="p">;</span><span class="w">

</span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">accounts</span><span class="p">;</span><span class="w">


</span><span class="k">begin</span><span class="w"> </span><span class="k">transaction</span><span class="p">;</span><span class="w">

</span><span class="k">update</span><span class="w"> </span><span class="n">accounts</span><span class="w">
   </span><span class="k">set</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">balance</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">20000</span><span class="w">
 </span><span class="k">where</span><span class="w"> </span><span class="n">account_no</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span></pre></div><div class="step step-level-1" step="34" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="54400" data-y="0" data-z="0"><pre class="highlight code sql"><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">account_changes</span><span class="p">(</span><span class="n">account_no</span><span class="p">,</span><span class="n">flag</span><span class="p">,</span><span class="n">amount</span><span class="p">,</span><span class="n">changed_at</span><span class="p">)</span><span class="w">
</span><span class="k">values</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="s1">'-'</span><span class="p">,</span><span class="mi">20000</span><span class="p">,</span><span class="n">datetime</span><span class="p">(</span><span class="s1">'now'</span><span class="p">));</span></pre></div><div class="step step-level-1" step="35" style="width: 1024px;" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="56000" data-y="0" data-z="0"><h1 id="references">References</h1><ul><li><a href="http://www.postgresql.org/docs/current/static/sql-grant.html">http://www.postgresql.org/docs/current/static/sql-grant.html</a></li><li><a href="http://www.postgresql.org/docs/current/static/sql-revoke.html">http://www.postgresql.org/docs/current/static/sql-revoke.html</a></li><li><a href="http://www.postgresql.org/docs/current/static/sql-createuser.html">http://www.postgresql.org/docs/current/static/sql-createuser.html</a></li><li><a href="http://www.postgresql.org/docs/current/static/sql-createrole.html">http://www.postgresql.org/docs/current/static/sql-createrole.html</a></li><li><a href="https://docs.oracle.com/cd/E11882_01/server.112/e10897/users_secure.htm#ADMQS0741">https://docs.oracle.com/cd/E11882_01/server.112/e10897/users_secure.htm#ADMQS0741</a></li><li><a href="https://docs.oracle.com/cd/F49540_01/DOC/server.815/a67772/dba.htm">https://docs.oracle.com/cd/F49540_01/DOC/server.815/a67772/dba.htm</a></li><li><a href="https://opentextbc.ca/dbdesign01/chapter/chapter-14-database-users/">https://opentextbc.ca/dbdesign01/chapter/chapter-14-database-users/</a></li><li><a href="https://en.wikipedia.org/wiki/Database_administrator">https://en.wikipedia.org/wiki/Database_administrator</a></li><li><a href="https://en.wikipedia.org/wiki/Database_administration">https://en.wikipedia.org/wiki/Database_administration</a></li><li><a href="https://www.oracletutorial.com/oracle-administration/">https://www.oracletutorial.com/oracle-administration/</a></li><li><a href="https://chartio.com/resources/tutorials/oracle-user-privileges--how-to-show-all-privileges-for-a-user/">https://chartio.com/resources/tutorials/oracle-user-privileges--how-to-show-all-privileges-for-a-user/</a></li><li><a href="https://docs.oracle.com/cd/E25178_01/oid.1111/e10029/oracle_and_oid.htm">https://docs.oracle.com/cd/E25178_01/oid.1111/e10029/oracle_and_oid.htm</a></li><li><a href="https://help.sap.com/doc/fiori_bs2013/1.0%202016-01/en-US/46/e42438f63966c6e10000000a1553f7/frameset.htm">https://help.sap.com/doc/fiori_bs2013/1.0%202016-01/en-US/46/e42438f63966c6e10000000a1553f7/frameset.htm</a></li><li><a href="https://intellipaat.com/blog/tutorial/oracle-dba-tutorial/database-backup-restore-and-recovery/">https://intellipaat.com/blog/tutorial/oracle-dba-tutorial/database-backup-restore-and-recovery/</a></li><li><a href="https://www.sqlshack.com/drop-sql-server-login-dependencies/">https://www.sqlshack.com/drop-sql-server-login-dependencies/</a></li></ul></div></div><div id="slide-number" class="slide-number">
         1
      </div><script type="text/javascript" src="js/impress.js"></script><script type="text/javascript" src="js/gotoSlide.js"></script><script type="text/javascript" src="js/hovercraft.js"></script><script type="text/javascript" src="js/MathJax/es5/tex-mml-chtml.js"></script><script type="text/javascript">
      document.getElementById("impress").addEventListener("impress:stepenter", update_slide_number, false);
    </script></body></html>